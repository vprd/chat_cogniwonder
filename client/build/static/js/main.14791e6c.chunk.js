(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{137:function(e,t,n){e.exports=n.p+"static/media/logo.2b68e57d.png"},141:function(e,t){e.exports="data:image/png;base64,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"},168:function(e,t,n){e.exports=n(250)},173:function(e,t,n){},194:function(e,t,n){},225:function(e,t){},228:function(e,t,n){},250:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(11),o=n.n(c),i=(n(173),n(34)),s=n(6),u=n.n(s),l=n(13),m=n(35),d=n(12),f=n(28),v=n(47),p=n(94),g=n.n(p);function b(){switch(window.location.origin){case"http://localhost:3000":return window.API_ENDPOINT="http://localhost:8000/",window.API_ENDPOINT;default:return window.API_ENDPOINT=window.location.origin+"/",window.API_ENDPOINT}}var E=n(73),h=n(130),w=Object(h.setupCache)({maxAge:9e5}),O=g.a.create({adapter:w.adapter}),j="".concat(b(),"api"),A=new m.a;function y(e,t){return x.apply(this,arguments)}function x(){return(x=Object(l.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.post(t,Object(f.a)(Object(f.a)({},n),{},{cookies:{mdn:A.get("mdn"),cwcc:A.get("cwcc")}}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var k={getconversations:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=j+"/conversations",e.next=3,y(n,{userid:t});case 3:if(a=e.sent,console.log(a.data.recent_activity),0!==a.data.length){e.next=7;break}return e.abrupt("return",!1);case 7:return r=Object(E.a)(a.data,[function(e){return e.recent_activity}],["desc","asc"]),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getmessages:function(){var e=Object(l.a)(u.a.mark((function e(t,n){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=j+"/messages",e.next=3,y(a,{conversation_id:t,page:n});case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),authenticate:function(){var e=Object(l.a)(u.a.mark((function e(t,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(j),e.prev=1,e.next=4,y(j+"/authenticate",Object(v.a)({},Number(t)?"mobile":"email",t));case 4:return a=e.sent,e.abrupt("return",a.data);case 8:return e.prev=8,e.t0=e.catch(1),console.log("authentication failed"),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}(),search:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=j+"/search",e.next=3,y(n,{user:t});case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),startconversation:function(){var e=Object(l.a)(u.a.mark((function e(t,n){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=j+"/startconversation",e.next=3,y(a,{ids:t,creator:n});case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),changeconversationname:function(){var e=Object(l.a)(u.a.mark((function e(t,n){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=j+"/nameconversation",e.next=3,y(a,{conversation_id:t,conversation_name:n});case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},S=n(283),C=n(74),N=n.n(C),G=Object(a.createContext)(),R=function(e){var t=e.children,n=Object(a.useState)(!1),c=Object(d.a)(n,2),o=c[0],s=c[1],m=Object(a.useState)({userid:0,name:""}),f=Object(d.a)(m,2),v=f[0],p=f[1],g=Object(i.b)().enqueueSnackbar;function b(){return(b=Object(l.a)(u.a.mark((function e(t,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.authenticate(t,n);case 2:return(a=e.sent)?(localStorage.setItem("email_pwd",t),p({mobile:a.mobile,email:a.email,first_name:a.first_name,last_name:a.last_name,id:a.id}),setTimeout((function(){return s(!0)}))):(g("Authentication failed",{variant:"error",anchorOrigin:{vertical:"bottom",horizontal:"center"},persist:!0,preventDuplicate:!0,action:function(){return r.a.createElement(S.a,{onClick:function(){return window.location.reload()}},r.a.createElement(N.a,null))}}),s(!1)),e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){console.log("user: ",v)}),[v]),r.a.createElement(G.Provider,{value:{authentication:o,Authenticate:function(e,t){return b.apply(this,arguments)},user:v}},t)},D=(n(194),new m.a);window.addEventListener("keydown",(function(e){e.ctrlKey&&"t"===e.key?(D.set("mdn","8884016724"),D.set("cwcc","cw5f35a349096779.421"),window.location.reload()):e.ctrlKey&&"r"===e.key&&(D.set("mdn","1234567890"),D.set("cwcc","cw5f35a349096779.421"),window.location.reload())}));var T=function(){var e=Object(a.useContext)(G).Authenticate,t="";return Object(a.useEffect)((function(){try{e(D.get("mdn"),D.get("cwcc"))}catch(t){}}),[]),onchange=function(e){"username"===e.target.id&&(t=e.target.value)},onsubmit=function(){var n=Object(l.a)(u.a.mark((function n(a){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a.preventDefault(),e(t);case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),r.a.createElement("div",{className:"login-page"},r.a.createElement("form",{action:"post",onSubmit:onsubmit},r.a.createElement("div",{className:"username"},r.a.createElement("input",{onChange:onchange,id:"username",type:"text",name:"email/mobile",placeholder:"email/mobile",required:!0})),r.a.createElement("button",{type:"submit"},"Log in")))},Z=n(25),P=n(294),Q=n(52),F=n.n(Q),B=new m.a,L="".concat(b());window.SOCKET_SETUP=0;var q=Object(a.createContext)(),H=function(e){var t=e.children,n=Object(a.useContext)(G).user,c=Object(a.useState)(!1),o=Object(d.a)(c,2),s=o[0],m=o[1],v=Object(a.useState)({}),p=Object(d.a)(v,2),g=p[0],b=p[1],h=Object(a.useState)({}),w=Object(d.a)(h,2),O=w[0],j=w[1],A=Object(a.useState)(),y=Object(d.a)(A,2),x=y[0],C=y[1],R=Object(a.useState)(!1),D=Object(d.a)(R,2),T=D[0],P=D[1],Q=Object(a.useState)(!1),H=Object(d.a)(Q,2),K=H[0],W=H[1],U=Object(i.b)(),M=U.enqueueSnackbar,J=U.closeSnackbar;Object(a.useEffect)((function(){var e,t=F()(L),n=F()(L+"conversations"),a=function(e){var t=Object(E.a)(e,[function(e){return e.recent_activity}],["desc","asc"]);m(t)};n.on("connect",(function(){console.log("conversation socket connected"),n.on("update",a),C(n)}));var c=function(){e&&setTimeout((function(){return J(e)})),M("connected",{variant:"success",autoHideDuration:2e3,preventDuplicate:!0}),Array.isArray(s)&&t.emit("subscribe",s.map((function(e){return{room:"conversation"+e.conversation_id}}))),t.on("disconnect",(function(){return e=M("disconnected",{variant:"error",autoHideDuration:5e3,preventDuplicate:!0,action:function(e){return r.a.createElement(S.a,{onClick:function(){return window.location.reload()}},r.a.createElement(N.a,null))}})}))};return t.on("connect",c),j(t),function(){t.removeListener("connect",c),n.off("update",a)}}),[s.length]);var I=Object(a.useCallback)(function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x&&x.emit("conversations",{action:"get",cookies:{mdn:B.get("mdn"),cwcc:B.get("cwcc")}});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),[x]);function X(){return(X=Object(l.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!t.length){e.next=6;break}return a=[].concat(Object(Z.a)(t),[n]).map((function(e){return e.id})),e.next=4,k.startconversation(a,n.id);case 4:return e.next=6,I();case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e){document.querySelector(".conversation".concat(e)).classList.add("unread-conversation")}function Y(e){try{document.querySelector(".conversation".concat(e)).classList.remove("unread-conversation")}catch(t){}}return Object(a.useEffect)((function(){if(O.on){var e=function(e){};O.on("online",e);var t=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g.conversation_id===t.conversation_id){e.next=4;break}return e.next=3,I();case 3:z(t.conversation_id);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("name"!==t.type){e.next=4;break}return e.next=3,I();case 3:b((function(e){return Object(f.a)(Object(f.a)({},e),{},{display_name:t.conversation_name})}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return O.on("convo-update",n),O.on("message",t),function(){O.off("online",e),O.off("message",t),O.off("convo-update",n)}}}),[O,g,I]),Object(a.useEffect)((function(){if(n.id){var e=F()("".concat(L,"notification").concat(n.id));return e.on("connect",(function(){})),e.on("notification",function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("newconversation"!==t.event){e.next=3;break}return e.next=3,I();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){e.removeAllListeners(),e.disconnect()}}}),[n,I]),Object(a.useEffect)((function(){I()}),[I]),Object(a.useEffect)((function(){Y(g.conversation_id)}),[g]),r.a.createElement(q.Provider,{value:{getmessages:function(e,t){return k.getmessages(e,t)},markUndread:z,startconversation:function(e){return X.apply(this,arguments)},markRead:Y,user:n,sock:O,openedconversation:g,setOpenedconversation:b,updateConversations:I,conversations:s,socketState:T,setSocketState:P,messagesLoad:K,setMessagesLoad:W,conversations_socket:x}},t)};function K(){return(K=Object(l.a)(u.a.mark((function e(){var t=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.length>0&&void 0!==t[0]?t[0]:.9,t.length>1?t[1]:void 0,e.abrupt("return",!1);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var W=n(133),U=n.n(W),M=n(132),J=n.n(M),I=n(136),X=n.n(I),z=n(134),Y=n.n(z),_=n(293),V=n(289),$=n(285),ee=n(288),te=n(287),ne=n(290),ae=n(286),re=n(135),ce=n.n(re),oe=n(131),ie=n.n(oe),se=n(256),ue=n(281),le=n(284),me=n(95),de=n.n(me),fe=new m.a;function ve(e){e.name;var t=e.changegroupname,n=e.setchangegroupname,c=Object(a.useContext)(q),o=c.openedconversation,i=c.conversations_socket,s=Object(a.useState)(""),u=Object(d.a)(s,2),l=u[0],m=u[1],f=Object(a.useState)(!1),v=Object(d.a)(f,2),p=v[0],g=v[1];return Object(a.useEffect)((function(){})),r.a.createElement($.a,{open:t,onClose:function(){return n(!1)},"aria-labelledby":"form-dialog-title"},p?r.a.createElement(ae.a,{style:{color:"red"},id:"form-dialog-title"},"Invalid group name"):r.a.createElement(ae.a,{id:"form-dialog-title"},"Group Name"),r.a.createElement(te.a,null,r.a.createElement(_.a,{onChange:function(e){m(e.target.value)},style:{color:p?"red":""},value:l,autoFocus:!0,margin:"dense",id:"name",label:"Name",type:"username",fullWidth:!0})),r.a.createElement(ee.a,null,r.a.createElement(V.a,{onClick:function(){return n(!1)},color:"primary"},"Cancel"),r.a.createElement(V.a,{onClick:function(){l.trim()?(i.emit("conversations",{action:"changename",conversation_id:o.conversation_id,conversation_name:l,cookies:{mdn:fe.get("mdn"),cwcc:fe.get("cwcc")}}),m(""),n(!1),g(!1)):g(!0)},color:"primary"},"change")))}var pe=function(){var e=Object(a.useContext)(q),t=e.getmessages,n=e.openedconversation,c=e.user,o=e.sock,s=e.updateConversations,m=e.messagesLoad,f=e.setMessagesLoad,v=Object(a.useState)([]),p=Object(d.a)(v,2),g=p[0],b=p[1],E=Object(a.useState)(0),h=Object(d.a)(E,2),w=h[0],O=h[1],j=Object(a.useState)(0),A=Object(d.a)(j,2),y=A[0],x=A[1],k=Object(a.useState)(null),C=Object(d.a)(k,2),N=C[0],G=C[1],R=Object(a.useState)(!1),D=Object(d.a)(R,2),T=D[0],Q=D[1],F=Object(a.useState)(!1),B=Object(d.a)(F,2),L=B[0],H=B[1],W=Object(i.b)().enqueueSnackbar;Object(a.useEffect)((function(){window.addEventListener("keydown",(function(e){e.ctrlKey&&"a"===e.key&&H((function(e){return W(!e+"",{variant:e?"error":"success",autoHideDuration:2e3,preventDuplicate:!0}),!e}))})),setTimeout((function(){(function(){return K.apply(this,arguments)})().then((function(e){G(e)}))}),0)}),[W]),Object(a.useEffect)((function(){document.querySelector(".message-input textarea").focus()})),Object(a.useEffect)((function(){O(0)}),[]),Object(a.useEffect)((function(){Object(l.a)(u.a.mark((function e(){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(n.conversation_id);case 2:return a=e.sent,b(a.messages),O(a.page),x(a.count),e.abrupt("return",(function(){b([])}));case 7:case"end":return e.stop()}}),e)})))()}),[n,t]);var U=Object(a.useState)(!1),M=Object(d.a)(U,2),J=M[0],I=M[1];Object(a.useEffect)((function(){var e=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.toxicity&&I(!0),t.conversation_id===n.conversation_id&&t.sender_id!==c.id?(t.delivering=!1,b((function(e){return[].concat(Object(Z.a)(e),[t])})),s()):t.sender_id===c.id&&b((function(e){return e.map((function(e){return e.tempid===t.tempid?(t.delivering=!1,t):e}))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o.on("message",e),function(){o.off("message",e)}}),[g,n,o,s,c]),Object(a.useEffect)((function(){return f(!1),function(){}}),[g,f]);var X=function(){var e=Object(l.a)(u.a.mark((function e(a){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Math.abs(a.target.scrollTop)>=Math.abs(a.target.scrollHeight-a.target.offsetHeight)&&!T&&g.length<y)){e.next=10;break}return Q(!0),e.next=5,t(n.conversation_id,w);case 5:r=e.sent,console.log("setting new messages"),b(r.messages),O(r.page),Q(!1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=Object(a.useState)(!1),Y=Object(d.a)(z,2),_=Y[0],re=Y[1],oe=Object(a.useRef)(),ie=function(){var e=Object(l.a)(u.a.mark((function e(){var t,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(oe.current=oe.current.trim(),t=document.querySelector(".message-input textarea"),a={tempid:Object(P.a)(),message:oe.current,sender:"".concat(c.first_name," ").concat(c.last_name),sender_id:c.id,conversation_id:n.conversation_id,date:new Date,delivering:!0},setTimeout((function(){s(),re(!1),t.value="",oe.current=""}),0),b([].concat(Object(Z.a)(g),[a])),x(y+1),t.focus(),!L){e.next=14;break}return e.next=11,N.check(oe.current);case 11:e.t0=e.sent.filter((function(e){return e.results[0].match})),e.next=15;break;case 14:e.t0=void 0;case 15:r=e.t0,a.toxicity=L&&r.length?r:void 0,o.emit("message",a);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement($.a,{open:J,onClose:function(){return I(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(ae.a,{id:"alert-dialog-title"},"Warning"),r.a.createElement(te.a,null,r.a.createElement(de.a,null),r.a.createElement(ne.a,{id:"alert-dialog-description"},"Toxicity will not be tolerated, all toxic messages will dissapear")),r.a.createElement(ee.a,null,r.a.createElement(V.a,{onClick:function(){return I(!1)},color:"primary",autoFocus:!0},"i understand"))),r.a.createElement("div",{className:"messages-container"},r.a.createElement("div",{onScroll:X,style:{opacity:m?"0":"1"},className:"messages-view"},T?r.a.createElement("div",{className:"loader"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null)):r.a.createElement(r.a.Fragment,null),g?function(e){var t=[];return e.forEach((function(e){t.length>0&&t[t.length-1][t[t.length-1].length-1].sender_id===e.sender_id?t[t.length-1].push(e):t.push([e])})),t}(g).map((function(e,t){return r.a.createElement(ge,{key:t,messages:e})})).reverse():r.a.createElement(r.a.Fragment,null)),r.a.createElement("div",{style:{opacity:m?"1":"0"},className:"loader message-loader"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null))),r.a.createElement("div",{className:"message-input"},r.a.createElement("textarea",{onChange:function(e){oe.current=e.target.value,oe.current.trim()?re(!0):re(!1)},onKeyDown:function(e){!e.shiftKey&&13===e.keyCode&&_&&(e.target.value="",ie())},type:"text",placeholder:"type something..."}),r.a.createElement(S.a,{disabled:!(_||!N),onClick:ie,className:"send-btn"},r.a.createElement(ce.a,null))))};function ge(e){var t=e.messages,n=Object(a.useContext)(G).user.id===t[0].sender_id?"sender":"";return r.a.createElement("div",{className:"message-block",id:n},r.a.createElement(se.a,null,t[0].sender[0]),r.a.createElement("div",{className:"messages"},t.map((function(e,t){return r.a.createElement(be,{key:t,message:e})})),r.a.createElement("span",null,t[0].sender)))}function be(e){var t=e.message,n=Object(a.useState)(!1),c=Object(d.a)(n,2),o=c[0],i=c[1];return Object(a.useEffect)((function(){i(!0)}),[]),r.a.createElement(ue.a,{in:o},r.a.createElement("div",{className:"message","data-message-id":t.message_id,id:t.delivering?"delivering-message":""},r.a.createElement("span",null,t.message),t.delivering?r.a.createElement(X.a,{id:"message-loader"}):r.a.createElement(r.a.Fragment,null),t.toxicity?r.a.createElement(de.a,null):r.a.createElement(r.a.Fragment,null)))}var Ee=function(e){var t,n=e.drawer,c=Object(a.useContext)(q),o=c.openedconversation,i=c.user,s=Object(a.useState)(!1),u=Object(d.a)(s,2),l=u[0],m=u[1];return Object.keys(o).length?(Array.isArray(o.conversation_name)&&!o.display_name&&(t=(t=Object(Z.a)(o.conversation_name)).filter((function(e){return e!==i.first_name})).join(", ")),o.display_name&&(t=o.display_name),console.log(o),r.a.createElement("div",{className:"chat-screen"},r.a.createElement("div",{className:"contact-header"},n.state?r.a.createElement(r.a.Fragment,null):r.a.createElement(S.a,{style:{marginRight:10},onClick:function(){return n.set(!n.state)}},r.a.createElement(ie.a,null)),o.conversation.length>2?r.a.createElement(le.a,{max:4},o.conversation_name.map((function(e,t){return r.a.createElement(se.a,{key:t},e[0])}))):r.a.createElement(se.a,null,t[0]),r.a.createElement("div",{className:"about"},r.a.createElement("h4",null,t),r.a.createElement(J.a,{className:"edit-icon",onClick:function(){return m(!0)}}),r.a.createElement(ve,{setchangegroupname:m,changegroupname:l}),r.a.createElement(S.a,{style:{marginLeft:"auto"}},r.a.createElement(U.a,null)))),r.a.createElement(pe,null))):r.a.createElement("div",{className:"start-chat"},r.a.createElement("img",{src:"https://img.icons8.com/nolan/256/speech-bubble.png",alt:""}),r.a.createElement("div",null,r.a.createElement(S.a,{onClick:function(){return n.set(!n.state)}},r.a.createElement(Y.a,null)),r.a.createElement("h2",null,"Chat")))},he=n(137),we=n.n(he),Oe=(n(228),n(3)),je=n(138),Ae=n.n(je),ye=n(292),xe=n(291),ke=n(139),Se=n.n(ke),Ce=n(295),Ne=n(140),Ge=Ae()((function(e){return{root:{display:"flex"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(252,"px)"),marginLeft:252,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},drawer:{width:252,flexShrink:0},drawerPaper:{width:252},drawerHeader:Object(f.a)(Object(f.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),content:{flexGrow:1,transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-252},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0}}})),Re=function(e){var t=e.drawer,n=Object(a.useState)(!1),c=Object(d.a)(n,2),o=c[0],i=c[1],s=Object(a.useContext)(G).user;return Object(a.useEffect)((function(){}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"menu"},r.a.createElement("header",null,r.a.createElement("img",{src:we.a,alt:"logo"}),r.a.createElement("h2",null,s.first_name),r.a.createElement(S.a,{style:{marginLeft:"auto"},onClick:function(){return t.set(!t.state)}},r.a.createElement(Se.a,null))),r.a.createElement(Te,null),r.a.createElement(De,{setaddconversationview:i})),o&&r.a.createElement(Pe,{setaddconversationview:i}))},De=function(e){var t=e.setaddconversationview;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"menu-options"},r.a.createElement("div",{className:"option",onClick:function(){return t(!0)}},r.a.createElement("img",{src:"https://img.icons8.com/cotton/64/000000/add-to-chat.png",alt:""}),r.a.createElement("span",null,"start chat"))))},Te=function(){var e=Object(a.useContext)(q).conversations;return Array.isArray(e)&&!e.length?r.a.createElement("div",{className:"empty-conversation-list"},"you have no conversations"):r.a.createElement(r.a.Fragment,null,e.length?r.a.createElement(Ne.a,{className:"conversation-list",duration:4e3},r.a.createElement(r.a.Fragment,null,e.map((function(e,t){return r.a.createElement(Ze,{key:t,conversation:e})})))):r.a.createElement("div",{className:"empty-conversation-list"},r.a.createElement("div",{className:"loader"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null))))},Ze=function(e){var t=e.conversation,n=Object(a.useContext)(G).user,c=Object(a.useContext)(q),o=c.openedconversation,i=c.setOpenedconversation,s=c.markRead,u=c.setMessagesLoad,l=function(){setTimeout((function(){document.querySelector(".messages-view").style.opacity="0",u(!0),document.querySelector(".message-input textarea").focus()}),100),i(t)},m=t.unread&&t.conversation_id!==o.conversation_id?"7px solid rgb(143, 255, 143)":"",d=t.conversation_name;return Array.isArray(d)&&(d=d.filter((function(e){return e!==n.first_name})).join(", ")),t.display_name&&(d=t.display_name),2===t.conversation.length?r.a.createElement(V.a,{style:{borderRight:m,textTransform:"none"},onClick:l,className:"conversation conversation".concat(t.conversation_id),"data-conversationid":t.conversation_id,id:t.conversation_id===o.conversation_id?"opened-conversation":""},r.a.createElement(se.a,null,d[0]),r.a.createElement("div",{className:"about"},r.a.createElement("h4",null,d))):r.a.createElement(V.a,{style:{textTransform:"none"},onClick:function(){s(t.conversation_id),l()},className:"conversation group-conversation conversation".concat(t.conversation_id),id:t.conversation_id===o.conversation_id?"opened-conversation":""},r.a.createElement(le.a,{max:3,spacing:"small"},t.conversation_name.map((function(e,t){return r.a.createElement(se.a,{key:t},e[0])}))),r.a.createElement("div",{className:"about"},r.a.createElement("h4",null,d)))};var Pe=function(e){var t=e.setaddconversationview,n=Object(a.useState)([]),c=Object(d.a)(n,2),o=c[0],i=c[1],s=Object(a.useState)([]),m=Object(d.a)(s,2),f=m[0],v=m[1],p=Object(a.useContext)(q),g=p.user,b=p.startconversation;Object(a.useEffect)((function(){}));var E=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.persist(),""===t.target.value){e.next=8;break}return e.next=4,k.search(t.target.value);case 4:n=e.sent,i(n.filter((function(e){return e.mobile!==g.mobile}))),e.next=9;break;case 8:i([]);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(e){t(!1)},w=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h(),b(f);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement($.a,{className:"conversation-add",open:!0,onClose:h},r.a.createElement(te.a,null,r.a.createElement("div",{className:"users-input"},r.a.createElement("h2",null,"Create"),f&&0!==f.length&&r.a.createElement("div",{className:"participants"},f.map((function(e,t){return r.a.createElement(Ce.a,{style:{margin:"4px"},key:t,icon:r.a.createElement(se.a,{style:{width:"22px",height:"22px"}},e.first_name[0]),label:e.first_name,onDelete:function(){!function(e){var t=f&&f.filter((function(t){return t.mobile!==e.mobile}));v(t)}(e)},variant:"outlined"})}))),r.a.createElement(_.a,{onChange:E,onSubmit:function(e){return e.preventDefault()},id:"conversation-adder",type:"text",name:"email/mobile",placeholder:"email/mobile",required:!0,autoComplete:"off",autoFocus:!0,margin:"dense",fullWidth:!0}),o&&0!==o.length&&r.a.createElement("div",{className:"suggestions"},o.map((function(e,t){return r.a.createElement("div",{key:t,onClick:function(){return function(e){var t=!1;f&&f.forEach((function(n){n&&n.mobile===e.mobile&&(t=!0)})),t||v([].concat(Object(Z.a)(f||[]),[e]))}(e)},className:"suggestion"},r.a.createElement("h4",null,e.first_name),r.a.createElement("p",null,e.mobile))}))))),r.a.createElement(ee.a,null,r.a.createElement(V.a,{onClick:h},"cancel"),r.a.createElement(V.a,{disabled:!f.length,onClick:w},"Start")))},Qe=function(){var e=Ge(),t=r.a.useState(!1),n=Object(d.a)(t,2),c=n[0],o=n[1],i=Object(a.useContext)(G).user;return Object(a.useEffect)((function(){setTimeout((function(){try{i.mobile&&o(!0)}catch(e){console.log("failed to open drawer")}}),3e3)}),[i]),r.a.createElement(H,{maxSnack:3},r.a.createElement("div",{className:"chat-page"},r.a.createElement("div",{className:e.root},r.a.createElement(xe.a,null),r.a.createElement(ye.a,{className:e.drawer,variant:"persistent",anchor:"left",open:c,classes:{paper:e.drawerPaper}},r.a.createElement(Re,{drawer:{set:o,state:c}})),r.a.createElement("main",{className:Object(Oe.a)(e.content,Object(v.a)({},e.contentShift,c))},r.a.createElement(Ee,{drawer:{set:o,state:c}})))))},Fe=n(141),Be=n.n(Fe);function Le(){console.log("enabling server debug mode");var e="".concat(b()),t=F()(e+"debug");window.localStorage.setItem("debug","true"),t.on("debug",(function(e){var t;1===e.length?(e=e[0],console.log(e)):(t=console).log.apply(t,Object(Z.a)(e))}))}var qe=function(){var e=Object(a.useContext)(G).authentication;return Object(a.useEffect)((function(){e&&setTimeout((function(){var e=document.querySelector("#intro-loader");e.style.opacity=0,e.style.height=0,e.style.margin=0,setTimeout((function(){var e=document.querySelector(".intro-sequence");e.style.opacity=0,setTimeout((function(){e.style.display="none"}),600)}),600)}),2e3)}),[e]),Object(a.useEffect)((function(){window.localStorage.getItem("debug")&&Le();var e=function(e){"d"===e.key&&e.ctrlKey&&(window.localStorage.getItem("debug")?window.localStorage.clear():Le())};return window.addEventListener("keypress",e),function(){return window.removeEventListener("keypress",e)}}),[]),r.a.createElement(r.a.Fragment,null,e?r.a.createElement(Qe,null):r.a.createElement(T,null),r.a.createElement("div",{className:"intro-sequence"},r.a.createElement("img",{src:Be.a,alt:""}),r.a.createElement("div",{className:"loader book",id:"intro-loader"},r.a.createElement("figure",{className:"page"}),r.a.createElement("figure",{className:"page"}),r.a.createElement("figure",{className:"page"}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(i.a,null,r.a.createElement(R,null,r.a.createElement(qe,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[168,1,2]]]);
//# sourceMappingURL=main.14791e6c.chunk.js.map